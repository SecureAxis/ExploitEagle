import requests
from bs4 import BeautifulSoup

EXPLOIT_DB_URL = "https://www.exploit-db.com/search"

def search_exploit_db(query):
    response = requests.get(EXPLOIT_DB_URL, params={"q": query})
    soup = BeautifulSoup(response.content, "html.parser")
    
    results = []

    for entry in soup.select(".exploit_list tbody tr"):
        title = entry.select_one("td.description a").text.strip()
        link = entry.select_one("td.description a")["href"].strip()
        date = entry.select_one("td.date").text.strip()

        results.append({
            "title": title,
            "link": link,
            "date": date
        })

    return results

if __name__ == "__main__":
    query = input("Enter your search query: ")
    exploits = search_exploit_db(query)

    if exploits:
        print(f"\nFound {len(exploits)} exploits for '{query}':\n")
        for exploit in exploits:
            print(f"Title: {exploit['title']}\nLink: {exploit['link']}\nDate: {exploit['date']}\n")
    else:
        print("No exploits found for your query.")

